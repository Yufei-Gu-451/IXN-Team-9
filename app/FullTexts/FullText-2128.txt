Measuring the concentration of a substance accurately is an essential part of many biomedical studies. Oftentimes, the measurement is carried out via a calibration experiment, wherein a standard sample containing a known concentration of the substance to be measured is diluted multiple times at the same dilution ratio, and experimental outcomes are acquired at each dilution. At the same time, the experimental outcomes are also taken for the clinical samples of interest. For example, a modern assay for quantifying proteins in a clinical sample is the multiplex bead array (MBA) assay. A typical run of the MBA assay is conducted on 96-well plates with some wells containing serial dilutions of standard samples, whose concentrations are known, and some wells containing clinical samples, whose concentration estimates are of interest. To estimate the substance concentrations in the clinical samples, the concentration-response relation first has to be established using the standard samples. Many methods have been proposed for fitting concentration-response or dose-response curves, including parametric, semiparametric (Nottingham and Birch,2000; Yuan and Yin,2011), nonparametric (Bornkamp and Ickstadt,2009), and model averaging methods (Faes et al.,2007; Morales et al.,2006). For nonlinear calibration problems, the parametric methods based on logistic curves are the most studied and are widely available in many commercial curve-fitting software, e.g., MasterPlex, Bio-Plex, GraphPad Prism, and StatLIA. The four-parameter logistic (4PL) model was introduced by D.J. Finney in 1970 (as mentioned in Rodbard and Frazier,1975), and the extension to a five-parameter logistic (5PL) model followed a few years later (Prentice,1976; Rodbard et al.,1978; Finney,1979). The 5PL model adds a fifth parameter to the model to allow the sigmoid curve to be asymmetric around its inflection point. It is worth mentioning that the first appearance of asymmetric logistic models dates back to Richards (1959) in the experimental botany literature. Given a dataset of the standard samples to fit a logistic concentration-response curve, often there are two model choices to make. The first is to choose an appropriate mean model between 4PL and 5PL, and the other is to choose proper outcome transformation and/or variance models to account for the heterogeneity of variance in assay responses. With regard to the latter, the power variance function is well accepted (Finney,1976; Davidian et al.,1988). In this paper we will focus on the mean model choice problem. In the literature, there has been only one study so far to the best of our knowledge: Gottschalk and Dunn (2005), which compared the two models by the relative bias of concentration estimates and concluded that 5PL performed better than 4PL when the true curve was asymmetric. However, the variability of the estimated concentrations was not taken into consideration in the comparison. The rest of the paper are organized as follows: InSection 2, we carry out a simulation study to compare the calibration performance of 4PL and 5PL using two criteria. InSection 3, we study the impact of the calibration model choice on the power of detecting the association between a binary disease outcome and the estimated concentrations. InSection 4, we use a real data example to illustrate how to choose between 5PL and 4PL in practice. We end with a discussion inSection 5. We assume the following model for assay responses:NoneNoneHereYis the assay response measured for a standard sample with log concentrationt, epsilonis a Gaussian noise, andNoneis a 5PL model with parameterNone. Noneis a vector of length 5. The parameterscanddare the lower asymptote and upper asymptote, respectively. The parameterfis the asymmetry parameter. Whenf= 1, the curve is symmetric around its inflection point and 5PL becomes 4PL. Log concentrations affect the outcome only throughu(t), which can be parameterized in several ways:NoneNoneNoneNone(3) is perhaps the most widely used parameterization. It has a simple form and can be easier to work with when deriving analytical formulae, but the parametersbandedo not have good interpretations. (4) is the g-h or Richard parameterization (Fong et al.,2012; Richards,1959). It looks complicated, butgis the inflection point of the logistic curve andhis the slope at the inflection point. The relationship between the first two parameterization isNoneandNone. (5) is a parameterization formally introduced by Liao and Liu (2009). It depends ontau, the mid-point or median effective dose (ED50), andb. taucan be expressed asNone. (6) is a new parameterization, which depends ontauandh.We will refer to this parameterization as thetau-h parameterization. The advantage of thetau-h parameterization is that it allows us to relatively easily generate a set of logistic curves that differ in their degrees of asymmetry, but share the same basic characteristics within a fixed window of log concentrations. We study the bias and variance of unknown sample concentration estimates through a simulation study. Data are simulated from (1) and (6) with c = 4.37, d = 10.24, tau = 82.0, h = {2.23,2.03,1.83,1.43,1.43,1.43},None, andNone. The values forc,d, tauare based on an arbitrarily chosen concentration-response curve observed in the HIV Vaccine Trials Network (HVTN) laboratory, while the set of values forfandsigmaare chosen to reflect the range of parameters observed. The seven curves are plotted inFig. 1. We refer to an asymmetric curve withf greater than 1 asright skewed,and to an asymmetric curve withf less than 1 asleft skewed. As shown in the left panel ofFig. 1, the left skewed curves are mostly located to the left of the 4PL curve and the right skewed curves are mostly located to the right of the 4PL curve. In addition, if we treat the logistic curve as a probability distribution function and differentiate with respect totto obtain the probability density function (pdf), the pdf corresponding to a curve withf greater than 1 appears right skewed while the pdf corresponding to a curve withf less than 1 appears left skewed. NoneNoneNoneNoneLeft: Seven logistic curves studied inSection 2. The vertical line intersects each curve at the mid-point. Middle and right: Differences in ABC and MSE (4PL-5PL) as a function offandsigma. Positive values are in favor of 5PL. From each standard curve, 20 standard samples are simulated at 10 uniquetranging fromNonetoNoneat threefold dilutions. Two replicates are simulated at uniquet.Corresponding to each set of standard samples, we also simulate 50 unknown samples with log concentrations ranging uniformly fromtmintotmax. There is only a single replicate for each unknown sample, because in real experiments, resource limitations often mean that we have no choice but to forgo replications of the unknown samples. The potential effect of having more than one replicate for each unknown sample can be studied indirectly in our simulation setup by comparing different values ofsigma. For each combination offandsigma, 2000 replicates of the simulation experiments are performed. LetNone0denote the true parameters of a concentration-response curve, and letF0denote the true concentration-response function. We will use the maximum likelihood method to estimate the parameters of the logistic model using the R packagesnCal(Fong et al.,2013) anddrc(Ritz and Streibig,2005). LetNonedenote the parameter estimate, and letNonedenote the estimated concentration-response function. The estimates of the log concentrations of the unknown samples can be found by inverting the logistic function and choosing a reasonable log concentration estimate whenever the unknown sample's experimental outcome lies outside of the range of the estimated asymptotes, e.g.,NoneHere we let the concentration estimate be half of the smallest standard sample concentration wheneveryis less than the estimated lower asymptote (Hornung and Reed,1990) and let the concentration estimate be the largest standard sample concentration wheneveryis greater than the estimated upper asymptote. Denote the true log concentration byt0. SupposeNone. The variance ofNoneunder the 5PL working model can be decomposed into two terms using the bivariate delta method:Nonewherekis the number of replicates for the unknown samples and equals 1 in the current simulation setup andy0= F0(t0). The first term assumes the curve can be estimated perfectly and is driven by the variability in the observed outcome from the unknown samples alone. The second term assumes the unknown sample can be measured perfectly and is driven by the variability in the curve estimate alone. The variance ofNoneunder the 4PL working model can be decomposed into two terms reflecting uncertainty inyandNonein a way similar to (8), but withNone0replaced by the limit ofNone. To compare the performance of 5PL and 4PL, we first consider an area-between-curve (ABC) criterion defined as follows:NoneHerec0andd0denote the true lower and upper asymptotes, respectively. The expectation is taken over the uncertainty inNoneand can be estimated by taking the average over the simulation samples. ABC has two interpretations. The first gives rise to its name. As illustrated by Supplementary Materials Fig. 1, ABC is proportional to the area between the estimated curve and the true curve betweencNoneandd0, thus it is a one-number summary of how well the curve is estimated. ABC also has the interpretation as the mean absolute deviation in log concentration estimates of unknown samples when (i)sigma= 0 and (ii)Yis uniformly distributed betweenc0andd0. In the middle panel ofFig. 1, we plot the differences in ABC between 4PL and 5PL as functions offunder different levels ofsigma. The results, also summarized in Supplementary MaterialsTable 1, show that overall 5PL performs better than 4PL. While 4PL has a slightly smaller ABC when the underlying curve is very close to being symmetric, it shows a greater disadvantage when the underlying curve is more asymmetric. The disadvantage of 4PL increases as the asymmetry increases as well as when the experimental noisesigmaincreases. NoneNoneNone OASIS TABLE HERE NonePowers of the logistic regression study under three selected values off, four selected values ofsigma, and three predictor distributions fromSection 3The comparison by the ABC criterion does not take into account the variability of the unknown sample measurements, and it can be viewed as focusing on how well we estimate the curve. To better study the quality of the estimated concentrations, we consider a mean squared error (MSE) criterionSdefined as follows:NoneThe summation oftis with regard to 50 unknown samples whose log concentrations are distributed uniformly betweentminandtmax. Results are summarized in the right panel ofFig. 1and in Supplementary MaterialsTable 1. Reversing the conclusion drawn from looking at the ABC criterion, 4PL performs overall better than 5PL by the MSE criterion except whenf= 0.4 and the advantage of 4PL appears to increase as the asymmetry gets stronger. These results are surprising at the first look, but can be understood with the help ofFig. 2. In this figure, the lower portion of a right skewed concentration-response curve is shown. The circle represents an observed response from an unknown sample with true log concentrationNone;NoneandNoneare the estimated concentrations for the unknown sample based on the 5PL fit and the 4PL fit, respectively. The fitted 5PL curve tracks the truth better than the fitted 4PL curve, as expected; butNoneis closer tot0thanNone. The apparent paradox is caused by the fact that the 4PL fitted curve has a steeper slope in this region. That results in a smallerNonein (8), hence a reduced variability of the estimated concentrations. NoneNoneNoneNoneA close look at 4PL and 5PL (right skewed) fits near lower asymptotes showing the advantage of 4PL model in terms of bias of log concentration estimates. t0represents the true log concentration. The y-axis value of the open circle represents a simulated assay response. NoneandNonerepresent the log concentration estimates using 4PL and 5PL model, respectively. In this section, we assume that the unknown samples log concentrations are uniformly distributed between the minimum and maximum standard samples concentrations. In practice, this is rarely the case. In the next section, we will examine in more detail how the calibration model choice may vary depending on the distribution of the unknown samples log concentrations. Nonlinear calibration produces the estimated concentrations of a substance in the samples of interest. In public health studies, these estimated concentrations are often studied as a potential biomarker associated with diseases. In this section, we investigate the impact of the mean model choice in nonlinear calibration on the power to detect the association between a binary disease outcome and a substance in a logistic regression framework. Each simulated dataset is composed of 250 clinical samples. For each sample, we simulate a binary disease outcome variable from a Bernoulli model with meanNone, wheretis the true log concentration of an analyte of interest. The regression coefficientsalphaandbetaare listed in Supplementary Materials Table 3, and they are chosen so that the power of rejectingbeta= 0 using concentration estimates is between 40% and 80%. Different fromSection 2where we assume a uniform distribution for the unknown samples log concentrations, here we investigate three different predictor distributions:low, medium, andhigh(Fig. 3). Each predictor distribution is an equal mixture of two normal distributions. The 2.5% and 97.5% quantiles of the three distributions are (-0.66, 2.90), (2.57, 5.83), and (5.67, 8.72) respectively. NoneNoneNoneNoneThree predictor distributions inSection 3. The mixture components of the predictor distributions:N(0.3, 0.5) andN(1.3,1) forlow(solid black line),N(4,0.8) andN(4.4, 0.8) formedium(solid gray line), andN(7.8, 0.5) andN(7, 0.8) forhigh(solid dashed line). We assume the 250 unknown samples need to be assayed in 5 batches, with each batch having its own standard samples. The standard curve parameters vary slightly across batches on the asymptotes only. Three values offare considered: a symmetric curve withf= 1, a left skewed curve with 0.2, and a right skewed curve withf= 12. The full parameters are shown in the Supplementary Materials Table 2. From each standard curve, as inSection 2, 20 standard samples are simulated at 10 distincttranging fromtmax= log(104) totmin= log (0.51) at threefold dilutions with two replicates per uniquet.In addition, we consider four levels of experimental noise:sigma= 0.01, 0.04, 0.08, and 0.2. The calibration performance of both the 5PL and 4PL models are examined across different true log concentrations inFig. 4. For eachf, one set of simulated standard samples are shown in the left panel, along with the true curve and the fitted curves. In the middle panel, the bias and variance are plotted as functions of the true log concentrations. To make the bias and variance more comparable, we show bias squared instead of bias. In the right panel, the MSEs are plotted as functions of the true log concentrations. Also shown are the average MSE for uniformly distributed true log concentrations. NoneNoneNoneNoneResults fromSection 3simulation studies. Left: Example datasets with fitted and true standard curves atsigma= 0.08. Middle: Bias squared and variance of the estimated log concentrations as functions of true log concentrations; var stands for variance, and bias sq stands for bias squared. Right: MSE as functions of true log concentrations. The horizontal lines are average MSE for uniformly distributed true log concentrations. For each simulation dataset, we obtain two sets of concentration estimates. We then regress the binary outcome variable on each set of concentration estimates using logistic regression. We also regress the binary outcome variable on the true log concentration as well as ony,the assay response variable. The simulation results from 2000 replications are shown inTable 1. When the true curve is symmetric, there is barely any difference in calibration performance and in power between the 4PL concentration estimates and the 5PL concentration estimates. In addition, there is little loss of power compared to using the true log concentrations in the association study. But there is loss of power if the assay response variable is used directly in regression. When the true curve is left skewed and the true log concentrations are simulated from the distribution with themediumrange,Table 1shows that there is little difference in power between 4PL and 5PL. Correspondingly, we see fromFig. 4(b)that the accuracy and precision of 4PL and 5PL concentration estimates are similar in this range. When the true log concentrations are simulated from thehighpredictor distribution, 4PL outperforms 5PL by 3-11% in power when less than italic greater than sigma greater than less than /italic greater than 0.01. InFig. 4(b), we see that in this range the 4PL concentration estimates have a smaller MSE than the 5PL driven by a smaller variance. Whensigma= 0.01, 5PL performs better by 2%, presumably because the bias is more important in this case. For thelowpredictor distribution, 5PL outperforms 4PL by 2-3%. InFig. 4(b), we see that in this range, the 5PL concentration estimates have a smaller MSE than 4PL. When the true curve is right skewed, the comparison is a mirror image of the comparison under the left skewed curve. Again, there is little difference between 4PL and 5PL under themediumpredictor distribution. For thelowpredictor distribution, 4PL outperforms 5PL by 2-8% when less than italic greater than sigma greater than less than /italic greater than 0.01. InFig. 4(c), we see that in this range the 4PL concentration estimates are less variable and have a lower MSE. Whensigma= 0.01, 5PL performs better by 1%. For thehighpredictor distribution, 5PL outperforms 4PL by 1-4%. InFig. 4(c), we see that in this range the 5PL concentration estimates have a smaller MSE than 4PL. The results in this section suggest that whether to choose 5PL or 4PL depends mostly on the shape of the concentration-response curve and the distribution of the true log concentrations. When the true log concentrations are not located in a flat region of the standard curve, 5PL generally performs better than 4PL; but when they do, 4PL may outperform 5PL due to bias-variance trade-off. Because in the real-life situation, we often try to design a calibration experiment to avoid having the true log concentrations located in a flat region of the standard curve, we suggest to use the 5PL model as the default choice in real data analysis. If the 5PL fitted curve is rather asymmetric and the estimated concentrations of the substance in the clinical samples are located in a flat region of the curve, we recommend to also estimate the concentrations using the 4PL model. In the next section, we illustrate the application of this model choice procedure with a real dataset. In this section, we use real data from the HVTN laboratory to illustrate how to choose between 5PL and 4PL for nonlinear calibration. The left panel ofFig. 5shows a run of the MBA assay measuring the concentrations of the cytokine TNF-beta. There are 20 standard samples located at 10 standard concentrations. The fitted 5PL curve is left skewed, and starts to plateau near the maximum standard concentration. But whereas the fitted 5PL standard curve is almost flat between the two most concentrated standard sample inFig. 4(b), here the fitted 5PL function still curves in that region. Hence we would choose to only do the default 5PL fit and not try the 4PL fit for this run of standard samples. NoneNoneNoneNoneResults fromSection 4real data illustration. Left: A representative dataset with fitted standard curves,None. Middle: Bias squared and variance of the estimated log concentrations as functions of true log concentrations; var stands for variance, and bias sq stands for bias squared. Right: MSE as functions of true log concentrations. The horizontal lines are average MSE across 10 standard log concentrations. Over a period of time, 26 runs of the MBA assay for measuring TNF-betaconcentrations were collected. This gives us an opportunity to validate our model choice. For each of the 26 * 20 standard samples in this dataset, we estimate its concentration using its observed outcome, in conjunction with the standard curve estimated from the other 19 standard samples in that specific run. We then compute the bias squared, variance, and MSE of the 52 estimated log concentrations at each of the 10 standard log concentrations. The results are plotted on the middle and right panels ofFig. 5, using the y-axis scale as inFig. 4(b)for an easy reference to the results inSection 3. The results show that in the range of the standard concentrations of this dataset, the difference between 5PL and 4PL fits is relatively small with 5PL performing slightly better. In this article we investigate the model choice between the 4- and 5-parameter logistic models for fitting concentration-response curves. Our Monte Carlo studies assume a 10-point standard curve with two replicates at each dilution. Our results show that the 5PL model is preferred if the estimated curve is of most interest. When concentration estimates matter more, due to the bias-variance trade-off, there are some conditions under which the 5PL model performs better and there are some conditions under which the 4PL model performs better. Based on these results, we conclude that the 5PL model is a good default model to use in nonlinear calibration. However, when the estimated concentrations of the substance in the clinical samples are concentrated in a flat part of the fitted 5PL curve, it may be worth the extra efforts to also estimate the concentrations using the 4PL model. If the goal of the study is to identify association between a binary disease outcome and a substance, this second set of estimated concentrations can be used in a sensitivity study to see if it may be more strongly associated with the disease outcome. Numerical stability is a factor that can impact the choice between 4PL and 5PL in practice besides analytical considerations. The numerical problem of fitting a 5PL model has been well documented (Seber and Wild,1989; Ratkowsky,1990,1986). From our experience, this problem can be alleviated to a degree by allowing the optimization routine to try several methods when choosing the initial values, e.g., as implemented in the R packagenCal(Fong et al.,2013). That our Monte Carlo studies use no knowledge about the simulation truth in the optimization process suggests the algorithm implemented therein is suitable for practical use. We thank the editorial board, the Associate Editor, and two anonymous referees for their helpful comments. We thank members of the Lab Data Operations at Statistical Center for HIV/AIDS Research Prevention (SCHARP) for assay data quality control, and members of the HVTN laboratory for performance of the assays. This work was supported by the cooperative agreement W81XWH-07-2-0067 between the Henry M. Jackson Foundation and the Department of Defense, the National Institute of Allergy and Infectious Diseases (NIAID), grant UM1-AI-068618 to the HIV Vaccine Trials Network, the Bill and Melinda Gates Foundation grant OPP1032317 to the Collaboration for AIDS Vaccine Discovery, and the NIAID grants AI104370 and AI029168. Supplemental data for this article can be accessed on thepublisher's website.