Based on the generalized Friedman's urn model[1], Wei proposed an urn design for sequential trials comparingm greater than = 2 treatments with equal allocations in 1978, as a compromise between the complete randomization (CR), which may result in large treatment imbalances, and the permuted block randomization (PBR), which has high allocation predictability[2]. Wei's urn design, denoted byUD(w,alpha,beta), starts from an urn withwballs color coded for each of them greater than = 2 treatments. When a subject is ready for randomization, a ball is drawn and replaced. The subject is assigned to the treatment represented by the ball. Then alpha more balls for the treatment andbetamore balls for each of the other treatments are added to the urn. Wei proved that the unconditional allocation probability for each treatment assignment in the UD converges to the equal allocation. Wei also indicated that the treatment allocation predictability of the UD was lower than that of the PBR, and the treatment imbalance was comparable to that of Pocock and Simon's Minimization method[2],[3]. The UD is easy to implement and is considered as one of the commonly used restricted randomization method in clinical trials[4]. In recent years, the use of unequal allocation in clinical trials is growing, partially due to the emergence of Bayesian adaptive designs[5]and response adaptive randomization[6]motivated by ethical, trial efficiency, economical, and patient recruitment feasibility considerations[4]. However, randomization designs for unequal allocations are largely limited to CR and PBR. The generalizing of the UD to unequal allocations has received some attentions. For example, in their book published in 2002, Rosenberger and Lachin briefly described a procedure to generalize Wei's UD from equal allocation to two-arm unequal allocations[4]. Recently in 2012, Kaiser pointed out that this generalization is incorrect and provided a fix for a specific scenario of unequal allocation 2:1[7]. In the same article, Kaiser described another randomization strategy for unequal allocationr1:r2between the experimental and the control arms as to perform randomization for equal allocation tor1 + r2treatment arms, and then combiner1of these arms for the experimental arm assignment andr2of these arms for control[7]. Kaiser did not provide details on the statistical properties of these two unequal allocation randomization procedures. In this manuscript, these two procedures described by Kaiser for unequal allocations are rigorously defined, evaluated, and compared to other commonly used unequal allocation randomization methods. Evaluation criteria include the unconditional allocation probability, the allocation predictability, the treatment imbalance, and their advantages and limitations under different trial scenarios. In Section2, notations and measures used in this article are defined. In Section3, a modified version of Wei's UD is proposed by using a provisional allocation. In Section4, an alternate approach using Kaiser's equal allocation randomization is introduced. In Section5, the performances of these two designs are compared with other randomization methods, and in Section6a discussion is provided. Letnbe the sample size,mbe the number of treatment arms,nNonedenote the number of subjects assigned to treatmentjafterisubjects have been randomized in to the study, andbNonerepresent the number of balls in the urn for treatmentjafterisubjects randomized. LetpNonebe the conditional allocation probability of assigning subjectito treatmentj. In an urn model, there isNoneLetuNonebe the unconditional allocation probability of assigning theith subject to treatmentjprior to the start of the trial. To prevent selection bias, it is desired that the unconditional allocation probability equals the target allocation probability for each treatment assignment[7],[10]. LetNonerepresent the allocation ratio desired by the study design. For example, when two treatments are compared to one single control, 1:1:2 is the optimal allocation defined by Dunnett[9]. By default, an allocation ratio is expressed in terms of allocation probabilities with the sum of allocation elements equals to 1. For example, 1:1:2 = 0.2929:0.2929:0.4142. Letr1:r2:? :rNonebe the allocation ratio targeted by the randomization algorithm. For example, using PBR for the Dunnett allocation, one may choose 2:2:3 = 0.2857:0.2857:0.4286 or 5:5:7 = 0.2941:0.2941:0.4118 as the target allocation. Recognizing the difference between the desired allocation and the target allocation is important because not all randomization designs are able to target any desired allocation. A randomization design is valid only if it has an asymptotic allocation equal to the target allocation. Based on the notations described above, the following measures are defined for the evaluation of randomization designs:Allocation precisionis measured by the Euclidian distance between the achieved allocation and the target allocation afterisubjects randomized,None. Allocation accuracyis measured by the Euclidian distance between the target allocation and the desired allocation multiplied by the sample size[8],None. Allocation errorNoneis measured by the Euclidian distance between the achieved allocation and the desired allocation afterisubjects. It increases asiincreases whenetais not negligible. NoneAllocation predictabilityis defined by the Euclidian distance between the conditional allocation probability and the target allocation probability for each treatment assignment[8],NonephiNoneequals zero when the CR is applied. Unlike to the correct guess probability defined based on the Blackwell and Hodges' convergence strategy[11], which applies to equal allocations only, measure (4) generally applies to both equal and unequal allocations. Desired features for a good randomization design for unequal allocations include:NoneNoneNoneNoneHigh allocation accuracy, represented by a small value ofeta, ideallyeta=0. High allocation precision, represented by a small value inNone. Low allocation predictability, represented by a small value inNone. Unconditional allocation probability equals to, or at least converges to, the target allocation probability, i.e. pNone = rNonefori = 1,2,? ; andj = 1,2,?,m. Wei's UD(w,alpha,beta) form greater than = 2 equal allocations can be defined by the conditional allocation probabilityNonefori = 1,2,? ;j = 1,2,?,m[12]. Historically, only integers are used for the constantsw,alpha, and betain the UD for easy illustration purpose. Theoretically,w and betacan be any positive number,alphacan be any real number. The ratiosalpha/wandbeta/wdetermine the UD. Letw = 1, Wei's UD procedure can be specified byNone. Rosenberger and Lachin described a modified urn design (mUD) for two-arm trials targeting an unequal allocation ofv1:v2[4]. Their urn starts from Refs. wv1andwv2color coded balls for the two treatment arms, respectively. To perform a subject randomization, a ball is randomly drawn from the urn and replaced. The subject is assigned to the treatment, e.g. 1, based on the color of the ball selected. After that,betav2balls are added to the urn for treatment 2. Otherwise,betav1balls are added to the urn for treatment 1[4]. The conditional allocation probability of the mUD in this case isNoneSincev1+v2 = 1 and bothwandbetaare positive real numbers, this formula can be simplify toNoneWhenbeta=0, the mUD is reduced to the CR. Whenbeta 0, and w.l.o.g., assuming0 v2 less than v1 less than 1, the unconditional allocation probability for the second subject is:NoneNoneThis inequality suggests that the unconditional allocation for the second assignment is affected by the value of parameterbeta. For example, withv1:v2 = 2/3:1/3 andbeta=1,u2,1 = 3/5 = 0.6. Similar calculation leads tou3,1 = 558/845 = 0.5905. These results are consistent with Kaiser's findings[7]. Whenbeta=10,u2,1 = 0.4214. Asbetaapproaches infinity,u2,1approachesv2 = 1 - v1. Although it is desirable for a randomization design to have an unconditional allocation probability that equals the target allocation probability at each treatment assignment, not all randomization designs have this property[8],[10]. However, it is necessary for all randomization designs to have an unconditional allocation probability that converges to the target allocation asymptotically. LetNonebe the asymptotic allocation ratio for the mUD. Wheni- greater than ?, the conditional allocation probability isNoneNoneThis leads to a quadratic equationNonewith its positive root representing the asymptotic allocation of the mUD as a function of the target allocation. NoneNoneBased on Eq. (3), if the original target allocation is 2:1 = 0.6667:0.3333, the mUD will asymptotically approach to the allocation0.5858:0.4142 = 2:1. Similarly, if the original target allocation is3:1 = 0.75:0.25, the asymptotic allocation will be 0.6340:0.3660 = 3:1, and so on. These results demonstrate that the mUD does not satisfy the necessary condition for a valid randomization algorithm, in two-arm unequal allocation scenario. Although the mUD discussed above does not converge to the original target allocationv1:v2, as shown in Section3.1, it does converge to an allocationr1:r2. This could be exploited to adjust the original target allocation provisionally, (hence termed provisional allocation) that would lead to the target allocation asymptotically. This goal is achieved by setting the provisional allocation in Eq. (3)toNoneFor example, to target an unequal allocation 2:1 = 0.6667:0.3333, use a provisional allocation of22:1 = 0.8:0.2. That is, using the allocation4:1 in the mUD, the randomization procedure will guarantee the allocation 2:1 in the long run, as shown in Eq. (3). Similarly, to achieve 3:1 = 0.25:0.75, or2:1 = 0.5858:0.4142, one can use the provisional allocation32:1 = 0.9:0.1, or 2:1 = 0.6667:0.3333, respectively. This procedure is named as modified urn design with provisional allocation (mUD-PA). For a two-arm trial with a target allocation ofr1:r2, the mUD-PA procedure starts fromr1andr2color coded balls for the two treatment arms respectively. When a subject is ready for randomization, a ball is randomly drawn from the urn and replaced. The subject is assigned to the corresponding arm. If a treatment 1 ball was drawn, addNoneballs to the urn. Otherwise, addNoneballs to the urn. The conditional allocation probability for this procedure isNoneNoneWhile the asymptotic allocation is invariant tobeta, the speed of allocation convergence, the allocation imbalance, and the allocation predictability are affected bybeta. Fig. 1shows the unconditional allocation probabilities for the first 10 treatment assignments for various values ofbeta. Notice, the larger thebeta, the faster the convergence of the unconditional allocation probability is achieved. Also notice, for the second assignment, largerbetaleads to larger shift in the unconditional allocation probability from the target allocation probability (see inequality (1)). InFig. 2, the allocation imbalance and the allocation predictability, as defined in Section2, are shown for the target allocation of 2:1. Notice inFig. 2with sample sizen = 12, smallerbetais associated with larger allocation imbalance and lower allocation predictability. The figure seems to suggest thatbetabetween 1.0 and 1.5 might be desirable for the target allocation of2:1,. NoneNoneNoneNoneNoneNoneUnconditional allocation probability under mUD-PA. Target allocation 2:1, simulation = 100,000/scenario. Allocation imbalance and predictability under mUD-PA. Target allocation 2:1, n = 12, simulation = 100,000/scenario. Under the mUD-PA, the unconditional allocation probability has small but noticeable drifts from the target allocation for the second and third treatment assignment. It quickly converges to the target allocation after that. It is worthwhile to emphasize that the mUD-PA is capable to accurately target any desired two-arm unequal allocations, including those involving large integers, such as 13:8, as well as irrational numbers, such as2:1. This feature makes the mUD-PA applicable for complex allocations even when the sample size is small. For example, for allocation 13:8, the PBR requires a minimal block size of 21, which is useful only when the sample (or stratum) size is large. On the other hand, the mUD-PA with a provisional allocation ofNonecan achieve the desired allocation when the sample size is not large. In his recent paper, Kaiser suggested that "a solution for r1:r2treatment allocation is to perform randomization for balanced allocation tor1 + r2treatment arms,and then combiner1of these arms for the experimental arm assignment and r2of these arms for control[7]." By applying this strategy to Wei's UD, a modified urn design via equal allocation (mUD-EA) is defined for targeting unequal allocations. For trialNonecomparingm greater than = 2 arms withunequalallocationr1:r2:? :rNone, envision trialNonecomparingNonearms withequalallocation. LetNoneandNonebe the treatment assignment for theith subject in trialsNoneandNonerespectively. The mapping relationship betweenNoneandNoneisNonewhenNone, withr0 = 0. The mUD-EA procedure works in the same way as Wei's UD(w,alpha,beta) for equal allocations, except the treatment mapping step. The conditional allocation probability for the mUD-EA procedure is:NoneNoneHere constantalphacould be positive, negative or zero, parameterbetais a positive number. Although allocation elementsrNoneare not necessarily integers, it is required thatNoneAs Wei's UD treats theMarms symmetrically, the unconditional allocation probability under the mUD-EA is preserved for each treatment assignment. The mUD-EA applies to all unequal allocations in trials with two or more arms without loss of allocation accuracy. Similar to Wei's UD, the mUD-EA behaviors close to the CR as the sample size increases. In the previous two sections both the mUD-PA and the mUD-EA were argued to be valid randomization algorithms for unequal allocations. Currently, the PBR and the CR are the two most commonly used methods for unequal allocations. Both of them have unconditional allocation probabilities equal to the target allocation for each treatment assignment. A few other randomization designs have also been proposed in the recent years, including the maximal procedure (MP)[13], the block urn design (BUD)[14], and the mass weighted urn design (MWUD)[8]. Using the notations specified in Section2, the conditional allocation probability for the PBR can be obtained from an urn model[5]:NoneNonewhere kNone - 1 = int(i - 1/b), withint(x) denoting the largest integer not exceedingx. The same urn model can be used for the BUD, with the exception of the ball return rule[14]:NoneNoneNoneWhen the minimal block size is used, the BUD and the PBR are identical. The MWUD starts from one ball in the urn for each treatment, with the mass of the balls proportional to the target allocation probability, and the sum of the mass of all balls equalsb. The probability a ball being picked in a random draw is proportional to its mass. After the subject is assigned to the treatment, the mass of this ball is reduced by one unit before the ball is returned to the urn. This unit amount of mass is distributed to all treatment arms based on the allocation ratio[8]. The conditional allocation probability for the MWUD is:NoneNoneIncluded in the simulation study are four trial scenarios composed by two levels for sample size (small and large) and two types of allocation elements (small integers and irrational numbers). In practice, a large sample size may exceed 1000. However, restricted randomization designs are most likely applied within strata formed by the combination of baseline covariate categories, where 100 is considered large for an average stratum size. Eight randomization designs are included for each trial scenario. The parameters for each randomization design are selected with the consideration of performance optimization. Treatment imbalance is evaluated by the average allocation accuracy, the average allocation precision, and standard deviation of the treatment arm size. Allocation randomness is evaluated by the average allocation predictability, the proportion of deterministic assignments and the proportion of complete random assignments. As shown inTable 1, for small trials with unequal allocations composed by small integers, both mUD-PA(2) and mUD-EA(0,2) could be considered as good options, if the allocation randomness is the primary concern. For allocations involving irrational numbers, both mUD-PA(2) and mUD-EA(0,2) can accurately target the desired allocation and offer low allocation predictability and treatment imbalance similar to that for PBR(12). For large trials, the allocation imbalances for both mUD-PA(2) and mUD-EA(0,2) are significantly larger than those for PBR, MUD, MP, and MWUD. This is expected because mUD-PA and mUD-EA are extensions of Wei's UD, which is designed mainly for small trials. However, when the desired allocation includes irrational numbers, the disadvantage of the PBR becomes clearer as the sample size increases. When the randomization algorithm cannot target the desired allocation, as the sample size increases, the treatment allocation accuracy will decrease proportionally. In this situation, the mUD-PA and mUD-EA remain valuable if allocation randomness is important. In general, the MWUD offers a better combination of low allocation predictability and small allocation imbalance than other randomization designs; although the unconditional allocation probabilities for the first few assignments are not exactly the same as the target allocation probability. Fig. 3shows the unconditional allocation probability for the first 10 assignments under MWUD(3) and mUD-PA(2). NoneNoneNoneNoneNoneNoneNoneUnconditional allocation probability under MWUD mUD-PA. Simulation = 100,000/scenario. Performance Comparison of Randomization Designs for Unequal Allocations 10,000 simulations per scenario Occurs when the sample size is a multiple of the block size. Fig. 3demonstrates that, the shift in the unconditional allocation probability for MWUD(3) is trivial. For the mUD-PA(2), after three assignments, the difference between the unconditional allocation probability and the target allocation probability is negligible. Wei's UD is well known and has been widely used for equal allocations. As unequal allocations are receiving more attention in clinical trials, the generalization of Wei's UD to unequal allocation provides investigators more options than just the CP, which may result unwanted imbalances, and the PBR, which has been criticized for its vulnerability to selection bias due to the low allocation randomness and may be unable to target the desired allocation accurately. The two randomization procedures presented in this manuscript, the mUD-PA and the mUD-EA, offer alternatives with desirable features, especially when the sample size is small and the target allocation involves large or irrational numbers. In this manuscript the presentation of the mUD-PA was limited to two-arm scenarios. The extension of the provisional allocation strategy to trials with more than two arms requires additional works. With the availability of the mUD-EA and the MWUD, both are useful form greater than = 2 unequal allocations, immediate need for these extensions may not be warranted.