The interaction between electric current and magnetization in magnetic nanostructure devices and the control of this interaction have been realized through the prediction of the spin-transfer torque by Slonczewski and Berger [1],[2]. The transfer of spin angular momentum between the spin-polarized electrical current and the local magnetization has been observed in various magnetic devices, such as metallic spin-valves systems, magnetic tunnel junctions, and magnetic domain walls in permalloy nanowires [3],[4]. Based on these experiments, a number of technological applications have been proposed, e.g., STT-MRAMs, racetrack memories, and magnetic vortex oscillators [5],[6]. The fundamental physics underlying these phenomena is understood as due to a spin torque that arises from the transfer of the spin angular momentum between conduction free electrons and magnetization. In the original works of Berger and Slonczewski [1],[2], a homogeneous spin accumulation is assumed due to a current which flows through a first magnetic layer perpendicular to the interface into a second magnetic layer. The spin torque effect leads to an interaction between the spin-polarized current and the magnetization in the second layer. For magnetic multilayers it has been shown that a proper description of the magnetoresistance is essential to take into account the interplay between successive interfaces [7],[8],[9]. In order to calculate the spin torque transfer, the spin transport properties have to be calculated far beyond the interface. The original model of Berger and Slonczewski has been extended by taking into account the diffusion process of the spin accumulation by Shpiro et al. for one-dimensional systems [10]and by Garcia-Cervera and Wang [11],[12]for three-dimensional systems. There, the overall system of PDEs (SDLLG) is a quasilinear diffusion equation for the evolution of the spin accumulation coupled to the Landau-Lifshitz-Gilbert equation (LLG) for the magnetization dynamics. Existence of global weak solutions to LLG goes back to [13], while, in the same spirit, existence of global weak solutions to SDLLG is proved in [11]. The reliable numerical integration of LLG (and, in particular, SDLLG) faces several challenges due to the nonuniqueness of weak solutions, the explicit nonlinearity, and an inherent nonconvex modulus constraint. Numerical approximation schemes for weak solutions of LLG are first proposed in [14],[15]. First unconditional convergence results can be found in[16],[17], which consider the small-particle limit of LLG with exchange only. On the one hand, the integrator of [16]relies on the midpoint rule and reduced integration, and thus has to solve one nonlinear system of equations per time-step. On the other hand, the tangent plane integrator of [17], which extends the prior works [14],[15], relies on a reformulation of LLG which is solved for the discrete time derivative. Each time-step consists of the solution of one linear system of equations plus nodal projection. It has been generalized to linear-implicit time integration and full effective field in [18],[19]. Numerical integration of the coupling of LLG to other time-dependent PDEs has been analyzed in [20],[21]for the full Maxwell equations (MLLG), in [22],[23]for the eddy current formulation, and in [24]for LLG with magnetostriction. While [20]analyzes an extension of the midpoint scheme of [16], the works [21],[22],[23],[24]extend the tangent plane scheme from [17], and emphasis is on the decoupling of the time-marching scheme in [21],[23],[24]. In the models and works mentioned, e.g., MLLG, the coupling of LLG and Maxwell equations is weak in the sense that the magnetization of LLG only contributes to the right-hand side of the Maxwell system, while the magnetic field from the Maxwell equations gives a contribution to the effective field of LLG. In SDLLG the principal part of the differential operator of the spin diffusion equation depends nonlinearly on the magnetization. A first numerical integrator for SDLLG is proposed and empirically validated in [12]. While this scheme appears to be unconditionally stable, the work does not prove convergence of the discrete solution towards a weak solution of SDLLG. In our work, we extend the tangent plane integrator to SDLLG and prove unconditional convergence. Altogether, the contributions of the current work can be summarized as follows:NoneNoneNoneThe proposed integrator is proven to converge (at least for a subsequence) towards a weak solution of SDLLG. This convergence is unconditional, i.e., there is no CFL-type coupling of the time and space discretizations. Despite the nonlinearity of SDLLG, each time-step requires only the solution of two successive linear systems, one for (the discrete time derivative of) the magnetization and one for the spin accumulation. Our analysis thus provides, in particular, an alternate proof for the existence of (global) weak solutions of SDLLG, which has first been proved in [11]. In addition to [11], we prove that any weak limit of the proposed integrator satisfies an energy estimate similar to the theoretical behavior of (formal) strong solutions of SDLLG. Unlike prior work on the tangent plane integrator, we adopt an idea from [25]and show that the nodal projection step of the tangent plane scheme isnotnecessary. In particular and unlike the cited works, our analysis can therefore avoid a technical angle condition on the triangulations used. This result also transfers to the models and analysis of [17],[18],[19],[21],[24],[23]and simplifies their (extended) tangent plane integrators. The paper is organized as follows: In Section 2, we introduce and accurately describe the mathematical model, see(9)for the nondimensional formulation of SDLLG. In Section 3, we formulate a decoupled time-marching scheme (Algorithm 6) for the numerical integration of SDLLG and prove its well-posedness (Proposition 9). Section 4contains the main result of our work (Theorem 12), which states unconditional convergence of the scheme towards weak solutions of SDLLG. Following [11], weak solutions of SDLLG have finite energy. In Section 5, we prove that any weak limit obtained by the proposed numerical integrator shows the same energy behavior as formal strong solutions of SDLLG (Theorem 24). Numerical examples as well as the empirical validation of the proposed algorithm are postponed to a forthcoming paper [26]. We use the standard notation [27]for Lebesgue and Sobolev spaces and norms. For any domainNone, we denote theNonescalar product byNonefor allNone. In the case of (spaces of) vector-valued functions, we use bold letters. For a sequenceNonein a Banach spaceNoneandNone, we writeNone(resp. None) inNoneif the sequence converges strongly (resp. weakly) toNoneinNone. Similarly, we writeNone(resp. None) inNoneif there exists a subsequence ofNonewhich converges strongly (resp. weakly) toNoneinNone. Throughout the paper,Nonedenotes a generic positive constant, independent of the discretization parameters, not necessarily the same at each occurrence. Alternatively, we writeNoneto abbreviateNone. GivenNone, we denote byNonethe tensor product defined byNonefor allNone. ByNone, we denote both the Frobenius norm of a matrix and the Euclidean norm of a vector. Since the meaning is clear from the argument, this does not lead to any ambiguity. In this section, we present the mathematical model, for which we introduce a nondimensional formulation, as well as the notion of a weak solution. We use physical units in the International System of Units (SI). We consider a magnetic multilayer. LetNonebe polyhedral Lipschitz domains inNone, whereNonecorresponds to the volume occupied by the multilayer, andNonecorresponds to the ferromagnetic part. A possible experimental setup is shown inFig. 1. Given some finite timeNone, we consider the time-space domainsNoneandNone. In micromagnetics, the quantity of interest is the magnetizationNone, measured in ampere per meter (A/m). If the temperature is constant and far below from the Curie temperature of the ferromagnetic material,Noneis a vector field of constant modulusNone, withNonebeing the saturation magnetization (in A/m). In the absence of spin currents, the dynamics ofNoneis described by the Landau-Lifshitz-Gilbert equation (LLG), which, in the so-called Gilbert form, readsNoneNoneHere,None(radian per second per tesla) andNone(Newton per square ampere) are the gyromagnetic ratio and the permeability of vacuum, respectively, whileNoneis the nondimensional empiric Gilbert damping parameter. The effective fieldNone, measured in A/m, depends onNoneand is proportional to the negative functional derivative of the total magnetic Gibbs free energy with respect toNone, i.e., NoneNoneIn(2)the energy functional readsNoneNoneand consists of four terms, which correspond to the exchange energy, the anisotropy energy, Zeeman's energy, and the magnetostatic energy, respectively. In(3),Noneis the so-called exchange stiffness constant, measured in joule per meter (J/m), andNoneis the anisotropic constant (in J/m3), whileNoneis a (nondimensional) smooth function, which takes into account the anisotropy of the ferromagnetic material. Moreover,Noneis a given external field (in A/m), whileNonerefers to the magnetostatic potential, which is the unique solution of the full-space transmission problemNoneNoneNoneNoneNoneCombining(2),(3), we obtain the following expression for the effective field:NoneNonewhereNonedenotes the stray field (in A/m). The dynamics of the spin accumulationNone, measured in A/m, is described by the diffusion equationNoneNonewhereNoneis the diffusion coefficient (in m2/s),Noneis the characteristic length of the spin-flip relaxation, andNoneis related to the mean free path of an electron (both measured in m). The spin currentNone, measured in A/s, is defined byNoneNonewhereNoneis the Bohr magneton,Noneis the charge of the electron, andNoneis the applied current density field (in A/m2), while the constantsNoneare the nondimensional spin polarization parameters of the magnetic layers. In(6)we denote byNonethe matrix-vector product between the transpose of the JacobianNoneandNone, i.e.,None. In(5)-(6), it is implicitly assumed thatNonein the nonmagnetic but conducting materialNone. To describe the dynamics of the magnetization, we take into account the interaction between the spin accumulation and the magnetization. Thus, we consider an augmented version of(1), namelyNoneNonewhere the constantNonein N/A2is the strength of the interaction between the spin accumulation and the magnetization. Finally, to complete the setting,(5),(6),(7)are supplemented by initial conditionsNonefor some given initial statesNoneandNonewithNone, and homogeneous Neumann boundary conditionsNoneWe introduce a nondimensional form of the system(5),(6),(7). We perform the substitutionNone, withNonebeing the so-called (nondimensional) reduced time, and setNone. We rescale the spatial variable byNone, withNonebeing a characteristic length of the problem (measured in m), e.g., the intrinsic length scaleNone. However, to simplify our notation, we writeNone, andNone, instead ofNone, andNone, respectively. We introduce the nondimensional vector unknownsNone, so that the modulus constraint becomesNone, andNone. Furthermore, we setNoneandNone. With these substitutions, the nondimensional augmented form of LLG becomesNonewhere the effective field is given byNoneNonewithNoneandNone, while the diffusion equation(5)readsNoneTo simplify our notation and without loss of generality, we assume thatNone. To sum up, we seek forNonewithNoneandNonesuch thatNoneNoneNoneNoneNoneNoneHere,NoneandNoneare constants. For the diffusion coefficientNone, we assume that there exists a positive constantNonesuch thatNonea.e. inNone. We also assume thatNoneandNone. Moreover, in(9a)we allow a more general effective field of the formNoneNonewhereNoneis a general time-independent field contribution. We emphasize that(10)in particular covers(8)withNone. NoneNoneThe constraintNonedirectly follows from the PDE formulation, providedNoneinNone. Indeed, from(9a), we deduce thatNoneinNone. LetNonebe the dual space ofNoneand denote byNonethe corresponding duality pairing, understood in the sense of the Gelfand tripleNone. In view of the weak formulation of(9b), we consider the time-dependent bilinear formNonedefined byNonefor allNoneandNone. We recall from [11, Definition 1]the notion of a weak solution of the SDLLG system(9), which extends the definition of weak solutions of LLG from [13]. NoneNoneLetNonewithNonea.e. inNone, andNone. The pairNoneis called a weak solution of SDLLG if the following properties (i)-(iv) are satisfied:NoneNoneNoneNoneNonewithNonea.e. inNoneandNonein the sense of traces,NoneandNonein the sense of traces,for allNone, it holdsNonefor almost allNoneand allNone, it holdsNoneNoneNoneNoneIfNoneis a weak solution of SDLLG, then it holdsNoneandNone, cf., e.g., [27, Section 5.9.2, Theorems 2 and 3]. NoneNoneThe following lemma highlights the parabolic nature of Eq. (9b). NoneNoneThe boundary term in(11b)is missing in [11]. This error has recently been noticed and corrected, so that the overall result of [11]remains valid [28]. The present analysis provides an alternate proof for the existence of solutions and hence validity of the results of [11],[28]. The time-dependent bilinear formNoneis continuous and positive definite. Indeed, it holdsNoneNonefor almost allNone. NoneNoneThe continuity directly follows from the regularity assumptions on the data, asNonea.e. inNone. As for the positive definiteness, we noteNoneAs a consequence, sinceNoneandNone, we getNoneThis establishes(12)and concludes the proof. ? For the time discretization, we consider a uniform partitionNoneof the time intervalNonewith time-step sizeNone, i.e.,NoneforNone. Given a sequence of functionsNone, such that anyNoneis associated with the time-stepNone, forNonewe define the difference quotientNone. We consider the piecewise linear and the two piecewise constant time-approximations defined as follows: forNoneandNone, we haveNoneNoneObviously, it holdsNonefor allNone. For the spatial discretization, letNonebe a shape-regular and (globally) quasi-uniform family of regular tetrahedral triangulations ofNone, parameterized by the mesh sizeNone, whereNonefor allNone. ByNone, we denote the restriction ofNonetoNone. We assume thatNoneis resolved, i.e., NoneLet us denote byNonethe standard finite element space of globally continuous and piecewise affine functions fromNonetoNone. Correspondingly, we also considerNone. ByNoneandNone, we denote the nodal interpolation operators onto these spaces. SinceNoneis resolved, these operators coincide onNone, i.e.,Nonefor allNone. In particular, there is no ambiguity, if we denote both operators byNone. The set of nodes of the triangulationNoneis denoted byNone. We recall that, under the constraintNone, the strong form of(9a)can equivalently be stated asNoneNoneThis formulation is used to construct the upcoming numerical scheme. Since(14)is linear inNone, the main idea is to introduce an additional free variableNone. To discretizeNone, we introduce the discrete tangent space defined byNonefor anyNone. Moreover, we consider the setNoneThese sets reflect two main properties ofNoneandNone, namely the orthogonalityNoneand the unit-length constraintNone. LetNone. We consider the nodal projection mapNonedefined byNonefor allNoneandNone. A simple argument based on the elementwise use of barycentric coordinates shows thatNonefor allNone. Moreover, we have the estimateNoneNonewhere the constantNonedepends only on the shape-regularity of the triangulation, cf., e.g., [25, Lemma 2.2]. With an additional angle condition onNone, it is well known that(15)holds even withNone, cf. [29]. LetNoneandNonebe suitable approximations of the initial conditions. Moreover, we consider a numerical realizationNoneofNone, which is assumed to fulfill a certain set of properties, see (H2)-(H3) below. This allows us to include the approximation errors, e.g., those which arise from the numerical computation of the stray field, into the overall convergence analysis. For ease of presentation, we assume thatNoneandNoneare continuous in time, i.e.,NoneandNone, so that the expressionsNoneandNoneare meaningful for allNone. It is even possible to replaceNoneandNoneby some numerical approximationNoneandNoneas long as some weak convergence properties are fulfilled, cf. [19]. Analogously to what we have done in Section 2for the continuous problem, forNonewe define the bilinear formNonebyNonefor allNone. For the numerical integration of the SDLLG system(9), we propose the following algorithm. NoneNoneNoneThe overall system(9)is a nonlinearly coupled system of a linear diffusion equation forNonewith the nonlinear LLG equation forNone. However, our scheme only requires the solution of two linear systems per time-step, since the treatment of the micromagnetic part and the spin diffusion part is completely decoupled for the time-integration. This greatly simplifies an actual numerical implementation as well as the possible preconditioning of iterative solvers. NoneNoneThe following result follows from standard scaling arguments. NoneNoneThe following proposition states that the above algorithm is well defined, cf. [25, Propositions 3.1 and 4.1]for corresponding results in the frame of harmonic maps and the harmonic map heat flow. NoneNoneInput:None, parameterNone. For allNoneiterate:NoneNoneNoneOutput: Sequence of discrete functionsNone. computeNonesuch thatNonefor allNone;defineNonebyNoneNonecomputeNonesuch thatNoneNonefor allNone. Unlike this work, earlier results on the tangent plane integrator [17],[18],[19],[20],[21],[22],[23],[24]defineNonein(16b). Unconditional convergence in the sense ofTheorem 12can then be achieved with an additional angle condition on the triangulationNone, which ensures(15)withNone. This assumption is avoided in the present work. LetNonebe a quasi-uniform family of triangulations ofNoneandNone. Then,NoneThe constantNonedepends only onNone, but is independent of the mesh sizeNone. ? Algorithm 6 is well defined in the following sense: for each time-stepNone, there exists a unique solutionNone. Moreover, it holdsNoneNoneas well asNoneNonewhere the constantNonedepends only on the shape-regularity ofNone, but is independent ofNoneandNone. NoneNoneLetNone. For step (i) of the algorithm, it is straightforward to show that problem(16a)is characterized by a positive definite bilinear form. Unique solvability thus follows from linearity and finite space dimension. Step (ii) is clearly well defined. For allNone, the nodewise orthogonality fromNoneprovesNoneSinceNone, mathematical induction provesNoneThis proves(17). The norm equivalence fromLemma 8in the caseNoneyieldsNoneThis establishes(18). For step (iii), we use the same argument as for step (i). Due to(17), the nodewise projections in(16c)are well defined. LetNonebe the bilinear form associated to problem(16c), i.e., NoneSinceNone, we seeNoneIt follows thatNoneAsNoneandNone,Noneis positive definite and problem(16c)is thus well posed. ? In this section, we consider the convergence properties ofAlgorithm 6and show that it is indeed unconditionally convergent towards a weak solution of SDLLG in the sense ofDefinition 2. We emphasize that the proof is constructive in the sense that it even shows existence of weak solutions. We start by collecting some general assumptions:NoneNoneNoneThe discrete initial dataNoneandNonesatisfyNoneThe general field contributionNoneis bounded, i.e., Nonewith a constantNonewhich depends only onNone. It holdsNonefor any sequenceNoneinNone. NoneNoneUsual stray field discretizations by hybrid FEM-BEM methods, e.g., the Fredkin-Koehler approach from [30], or FEM-BEM coupling methods satisfy (H2)-(H3), see [19]. NoneNoneFrom now on, we consider the time-approximationsNonedefined by(13). The next theorem is the main result of this work. NoneNoneFor a discrete operatorNone, assumption (H2) can be relaxed toNoneWithin this setting, and with an appropriate modification of assumption (H3), the hybrid FEM-BEM method from [31]for the computation of the stray field can also be included into our analysis. Then, the proof ofProposition 19becomes more technical, but the assertion remains true. We refer to the argument of [19]which can be adapted accordingly. LetNonebe a shape-regular and quasi-uniform family of triangulations. NoneNoneNoneSupposeNoneand that assumptions (H1)-(H2) are satisfied. Then, there existNoneandNonesuch thatNoneIn addition to the above, let assumption (H3) be satisfied. Then, it holdsNonewhereNoneis a weak solution of SDLLG. NoneNoneThe proof ofTheorem 12will roughly be done in three steps, namelyNoneNoneNoneFor the sake of readability, we split our argument into several lemmata. In particular,Theorem 12yields existence of weak solutions, and each accumulation point ofNoneis a weak solution of SDLLG in the sense ofDefinition 2. boundedness of the discrete quantities and energies,existence of weakly convergent subsequences via compactness,identification of the limits with weak solutions of SDLLG. To start with, we recall the following result, which states a well-known and simple algebraic trick which often simplifies the computation and the estimation of sums. NoneNoneNoneThe first ingredient for step (i) is the following proposition. NoneNoneLetNonebe a vector space endowed with a symmetric bilinear formNone. Given an integerNone, letNone. Then, it holdsNone ? LetNoneand suppose that the assumptions of Theorem 12(a) are satisfied. Then, the discrete functionsNoneobtained through Algorithm 6 fulfillNoneNoneThe constantNonedepends only on the data, but is in particular independent of the discretization parametersNoneandNone. NoneNoneLetNone. For(16c), we chooseNoneas test function. After multiplication byNone, we obtainNoneSinceNoneandNone, it follows thatNonecf. the proof ofLemma 5. Summing up overNone, and exploiting Abel's summation by parts fromLemma 14for the termNone, we getNoneExploitingNoneon the left-hand side, the Cauchy-Schwarz inequality and the Young inequality on the right-hand side, we obtain, for any choice ofNone,NoneHere the constantNoneis the stability constant of the trace operator. It follows thatNoneIf we chooseNone, then all the coefficients on the left-hand side are positive. From (H1) and the regularity ofNone, we know that the right-hand side is uniformly bounded with respect toNoneandNone. This yields the estimate(19). ? NoneNoneUnder the assumptions of Proposition 15, the sequencesNoneandNoneare uniformly bounded inNoneand inNone, i.e.,Nonewhere the constantNonedepends only on the data, but is in particular independent of the discretization parametersNoneandNone. NoneNoneLetNonebe theNone-orthogonal projection ontoNone, i.e., NoneSinceNoneis quasi-uniform, it is well known thatNoneis stable inNone, i.e., NoneNoneWe also refer to [32],[33]for recent results onNone-stability on locally refined meshes. With this, we obtain uniform boundedness ofNone. NoneNoneThe result follows from the boundedness of the discrete functionsNonefromProposition 15. ? The sequenceNoneis uniformly bounded inNone, i.e.,NoneNonewhere the constantNonedepends only on the data, but is in particular independent of the discretization parametersNoneandNone. NoneNoneWe derive the corresponding estimates for the discrete quantitiesNone. NoneNoneLetNone,None, andNone. From(16c)and theNone-stability(20)ofNone, we getNoneDividing byNoneand taking the supremum overNone, we obtainNoneSquaring, integrating overNone, and summing up overNone, we getNoneThe boundedness fromProposition 15thus yields(21). ? LetNone. The discrete functionsNoneobtained through Algorithm 6 fulfillNoneNoneNoneNoneWe test(16a)withNoneto getNoneExploiting the vector identityNonewith the choiceNoneandNone, and taking into account(16b), we obtain(22). ? NoneNoneSuppose that the assumptions of Theorem 12(a) are satisfied. Then, there existsNonesuch that for all time-step sizesNoneandNonethe discrete functionsNoneobtained through Algorithm 6 fulfillNoneNoneThe constantNonedepends only on the data andNone, but is otherwise independent of the discretization parametersNoneandNone. NoneNoneLetNone. FromLemma 18, multiplying(22)byNone, summing up overNoneand exploiting the telescopic sum, we obtainNoneThe Cauchy-Schwarz inequality and the Young inequality, together with assumption (H2), yield for anyNoneNoneFromProposition 9, we deduceNonewhere the constantNonedepends only onNoneandNone. We thus obtainNoneNote thatNone. If we chooseNone, forNoneall the coefficients on the left-hand side are positive. From the regularity ofNone, assumption (H1), and the boundedness fromProposition 15, we know that the right-hand side is uniformly bounded. This yields the estimate(23). ? NoneNoneUnder the assumptions of Proposition 19, and ifNone, the sequencesNoneandNoneare uniformly bounded. In particular, it holdsNonewhere the constantNonedepends only on the data andNone, but is independent of the discretization parametersNoneandNone. NoneNoneWe can now proceed with step (ii) of the proof and conclude the existence of weakly convergent subsequences. NoneNoneThe result follows from the boundedness of the discrete functionsNonefromProposition 9,Proposition 19, and from(15). ? Suppose that the assumptions of Theorem 12(a) are satisfied. Then, there existNoneandNone, withNonea.e. inNone, such that there holdsNoneNoneNoneNoneNoneNoneforNone. Moreover, there exists one subsequence for which (24) holds simultaneously. NoneNoneNoneNoneNoneThe boundedness results fromCorollary 20, in combination with the Eberlein-Smulian theorem, allow us to extract weakly convergent subsequences ofNoneandNone. LetNonebe such thatNoneinNone. From the continuous inclusionsNoneand the compact embeddingNone, we deduceNoneWithNone, we can identify the limits of the subsequences ofNoneandNone. AsNone, it clearly holds thatNonea.e. inNone. We now prove that the limiting functionNonesatisfies the unit-length constraint. First, we observe thatNoneNoneforNone. ForNoneandNone, a standard interpolation estimate for the piecewise linear functionNoneyieldsNoneFromProposition 19, we obtainNoneNoneFor allNone,Proposition 9and the discrete norm equivalence ofLemma 8withNoneyieldNoneThen, fromProposition 19, we deduceNoneNoneCombining(26)-(27), the triangle inequality thus yields thatNoneinNoneforNone, whenceNonea.e. inNonefollows from(25). ForNonewithNone, it holds thatNoneDue to(17), this yields for allNoneNonewhence by virtue ofProposition 19NoneThis impliesNoneinNoneasNone. SinceNone, we haveNoneeven inNoneas well asNoneinNone. FromCorollary 16, we similarly deduce the existence of weakly convergent subsequences ofNoneandNone. Due toProposition 15, the quantityNoneis bounded. This allows to identify the weak limits, sinceNoneFinally, fromProposition 17, we deduce the existence of a weakly convergent subsequence ofNone, and it is easy to see that its limit is preciselyNone, cf. [27, Section 7.1.2, Theorem 3]. This establishes(24e)-(24f)and thus concludes the proof. ? NoneNoneWe have collected all the ingredients for the proof of our main theorem. NoneNoneNoneNoneNoneNoneAs the constants which guarantee the boundedness ofProposition 15,Corollary 16andProposition 17, are independent ofNone, we deduce thatNone. The result of part (a) follows directly fromProposition 21. To conclude the proof of part (b), it remains to identify the limiting functionsNonewith a weak solution of SDLLG in the sense ofDefinition 2. To check(11a), we essentially proceed as in [17]. LetNone. ForNone, we test(16a)with respect toNone, withNonebeing the nodal interpolation operator ontoNone. Multiplication withNoneand summation overNoneyieldNonewhereNonefor allNone. From the well-known approximation properties ofNoneand the boundedness ofNonefromProposition 19forNone, we deduceNonePassing to the limit forNone, we obtainNoneIn the latter, we have used the convergence properties fromProposition 21, assumption (H3) for the general field contribution, as well asNoneandNoneinNone. Direct calculations and standard properties of the cross product yield the identitiesNoneNoneNonefrom which, by density, we deduce(11a). To check(11b), letNone. GivenNone, letNone. In(16c)we choose the test functionNone. Integration in time overNoneand summation overNoneyieldNoneNonewhereNonefor allNone. Passing(28)to the limit forNone, due to the convergence properties stated inProposition 21, in combination with the standard approximation properties ofNone, we deduceNoneBy density, this is also true for allNone. Hence in particular for eachNoneand a.e. Nonewe have(11b). SinceNoneinNonewithNone, andNoneinNonewithNone, assumption (H1) allows to deduceNoneandNonein the sense of traces. ? In this section, we exploit our constructive convergence proof to derive an energy estimate for weak solutions of SDLLG, which is also meaningful from a physical point of view. The total magnetic Gibbs free energy from(3)is strongly related to the standard form(1)of LLG and does not take into account the interaction between the magnetization and spin accumulation. As we are dealing with the augmented form(7)of LLG, we extend(3)and define the free energy of the system byNoneNoneThis definition is in agreement with(7), since in this case it is easy to see thatNonewhere the effective field is given by(4). A simple formal computation shows that strong solutions to(7)satisfyNoneNoneNeglecting the spin accumulation term and assuming thatNoneis constant in time, Eq. (30)reduces toNonewhich reveals the well-known dissipative behavior of solutions to the standard form(1)of LLG. The main aim of this section is to prove a property corresponding to(30)in the context of weak solutions. To this end, we move to the nondimensional framework introduced in Section 2and consider the following assumptions:NoneNoneNonethe operatorNonefrom(10)is linear, self-adjoint, and bounded;it holdsNonefor any sequenceNoneinNone, which is slightly stronger than (H3);the applied fieldNonebelongs toNone. NoneNoneUp to an additive constant, the nondimensional counterpart of(29)readsNoneNoneThe following theorem proves an energy estimate which generalizes(30)to weak solutions. NoneNoneFor some fixed easy axisNoneand the corresponding uniaxial anisotropy density functionNone, the operatorNoneNonesatisfies (H4). Moreover, all the stray field discretizations mentioned in Remark 10satisfy (H5), see [19]. The operatorNonefrom(31)is even well defined and bounded as operatorNonefor allNone, see [34]. Unlike [18], the proof of our energy estimate, seeTheorem 24, avoids this additional regularity, but only relies on the energy settingNone. Suppose that assumptions (H1)-(H2) and (H4)-(H6) are satisfied. LetNonebe a weak solution of SDLLG obtained as a weak limit of the finite element solutions from Algorithm 6 forNone. Then, the energy functional from (32) satisfiesNoneNonefor almost allNone. NoneNoneGivenNone, letNonesuch thatNone. LetNone. FromLemma 18, we getNoneBy definition(16b), it holdsNone. We thus obtainNoneAnalogously, we see thatNone. SinceNoneis linear and self-adjoint,(16b)also revealsNoneAltogether, we thus obtainNoneSinceNoneis a bounded operator, it follows thatNoneSummation overNoneand the boundedness fromProposition 19yieldNoneThe available convergence results onNone, andNone, as well as assumption (H5), allow us to employ standard arguments with weakly lower semicontinuity for the limitNone. This concludes the proof of(33). ?